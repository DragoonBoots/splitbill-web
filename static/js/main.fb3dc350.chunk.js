(this["webpackJsonpsplitbill-web"]=this["webpackJsonpsplitbill-web"]||[]).push([[0],{67:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a(0),c=a.n(l),r=a(20),s=a.n(r),i=a(40),j=a(23),d=a(42),o=a(39),u=a(13),b=a(18),x=a(28),h=(a(67),a(99)),O=a(96),m=a(97),v=a(58),p=a(98),f=a(94),y=a(101),g=a(92),k=a(12),N=a(100),T=a(102),w=a(95),D=a(8),R=a(93);function S(e){return Object(n.jsxs)(g.a,Object(k.a)(Object(k.a)({},e),{},{variant:"outline-secondary",children:[Object(n.jsx)("span",{className:"sr-only",children:"Move up"}),Object(n.jsx)("i",{className:"bi-arrow-up-circle-fill"})]}))}function C(e){return Object(n.jsxs)(g.a,Object(k.a)(Object(k.a)({},e),{},{variant:"outline-secondary",children:[Object(n.jsx)("span",{className:"sr-only",children:"Move down"}),Object(n.jsx)("i",{className:"bi-arrow-down-circle-fill"})]}))}function _(e){return Object(n.jsxs)(g.a,Object(k.a)(Object(k.a)({},e),{},{variant:"outline-success",children:[Object(n.jsx)("span",{className:"sr-only",children:"Insert below"}),Object(n.jsx)("i",{className:"bi-plus-circle-fill"})]}))}function I(e){return Object(n.jsxs)(g.a,Object(k.a)(Object(k.a)({},e),{},{variant:"outline-danger",children:[Object(n.jsx)("span",{className:"sr-only",children:"Remove"}),Object(n.jsx)("i",{className:"bi-x-circle-fill"})]}))}var A=function(e){return Object(n.jsxs)(R.a,{children:[Object(n.jsx)(S,{disabled:0===e.index,onClick:function(){return e.arrayHelpers.move(e.index,e.index-1)}}),Object(n.jsx)(C,{disabled:e.index===e.values.length-1,onClick:function(){return e.arrayHelpers.move(e.index,e.index+1)}}),Object(n.jsx)(_,{onClick:function(){return e.arrayHelpers.insert(e.index+1,e.values[e.index])}}),Object(n.jsx)(I,{disabled:1===e.values.length,onClick:function(){return e.arrayHelpers.remove(e.index)}})]})},B=a(57);var H=function(e){var t=e.children,a=e.eventKey;return Object(n.jsx)(g.a,{block:!0,variant:"link",className:"text-left text-truncate",onClick:Object(B.b)(a),children:t})};function J(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)(D.b,{as:p.a.Control,name:"lines.".concat(e.index,".name"),type:"text"}),Object(n.jsx)(D.a,{name:"lines.".concat(e.index,".name"),component:"div",className:"field-error"})]})}function P(e){return Object(n.jsxs)("div",{children:[Object(n.jsxs)(f.a,{children:[Object(n.jsx)(f.a.Prepend,{children:Object(n.jsx)(f.a.Text,{children:"$"})}),Object(n.jsx)(D.b,{as:p.a.Control,name:"lines.".concat(e.index,".amount"),type:"number",min:"0",step:"0.01"})]}),Object(n.jsx)(D.a,{name:"lines.".concat(e.index,".amount"),component:"div",className:"field-error"})]})}function L(e){return Object(n.jsxs)("div",{children:[Object(n.jsxs)(f.a,{children:[Object(n.jsx)(D.b,{as:p.a.Control,name:"lines.".concat(e.index,".tax"),type:"number",min:"0",step:"0.001"}),Object(n.jsx)(f.a.Append,{children:Object(n.jsx)(f.a.Text,{children:"%"})})]}),Object(n.jsx)(D.a,{name:"lines.".concat(e.index,".tax"),component:"div",className:"field-error"})]})}function V(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)(D.b,{as:p.a.Check,type:"checkbox",id:"lines.".concat(e.index,".usage"),name:"lines.".concat(e.index,".usage"),label:e.label}),Object(n.jsx)(D.a,{name:"lines.".concat(e.index,".usage"),component:"div",className:"field-error"})]})}function F(e){var t=e.values.lines.map((function(t,a){return Object(n.jsxs)(N.a,{children:[Object(n.jsxs)(N.a.Header,{className:"d-flex justify-content-between",children:[Object(n.jsx)(H,{eventKey:"lines.".concat(a),children:0===t.name.length?Object(n.jsx)("em",{children:"Untitled"}):t.name}),Object(n.jsx)(A,{index:a,values:e.values.lines,arrayHelpers:e.arrayHelpers})]}),Object(n.jsx)(T.a.Collapse,{eventKey:"lines.".concat(a),children:Object(n.jsxs)(N.a.Body,{children:[Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Name"}),Object(n.jsx)(J,{index:a})]}),Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Amount"}),Object(n.jsx)(P,{index:a})]}),Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Tax Rate"}),Object(n.jsx)(L,{index:a})]}),Object(n.jsx)(p.a.Group,{children:Object(n.jsx)(V,{index:a,label:"Usage"})})]})})]},a)}));return Object(n.jsx)(T.a,{defaultActiveKey:"lines.0",children:t})}function G(e){var t=e.values.lines.map((function(t,a){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)(J,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(P,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(L,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(V,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(A,{index:a,values:e.values.lines,arrayHelpers:e.arrayHelpers})})]},a)}));return Object(n.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{scope:"col",children:"Name"}),Object(n.jsx)("th",{scope:"col",children:"Amount"}),Object(n.jsx)("th",{scope:"col",children:"Tax"}),Object(n.jsx)("th",{scope:"col",children:"Usage"}),Object(n.jsx)("th",{scope:"col",children:Object(n.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),Object(n.jsx)("tbody",{children:t})]})}var M=function(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"d-md-none",children:Object(n.jsx)(F,Object(k.a)({},e))}),Object(n.jsx)("div",{className:"d-none d-md-block",children:Object(n.jsx)(G,Object(k.a)({},e))})]})},K=a(11),U=a(61),E=a.n(U);var $=function(e){var t,a,l=Object(D.g)().setFieldValue,c=Object(D.f)(e),r=Object(i.a)(c,1)[0],s=null,j=null,d=null!==(t=e.minDate)&&void 0!==t?t:null,o=null!==(a=e.maxDate)&&void 0!==a?a:K.DateTime.local().toISODate();function u(e,t){var a=null,n=null;Array.isArray(r.value)&&(a=r.value[0],n=r.value[1]);var c=[null!==e?e.toJSDate():a,null!==t?t.toJSDate():n];c.every((function(e){return null===e}))&&(c=null),l(r.name,c)}return Array.isArray(r.value)&&(s=K.DateTime.fromJSDate(r.value[0]).toISODate(),j=K.DateTime.fromJSDate(r.value[1]).toISODate()),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"d-md-none",children:Object(n.jsxs)(f.a,{children:[Object(n.jsx)(p.a.Control,{type:"date",value:s,min:d,max:j,onChange:function(e){var t=e.target;u(K.DateTime.fromISO(t.value),null)}}),Object(n.jsx)(p.a.Control,{type:"date",value:j,min:s,max:o,onChange:function(e){var t=e.target;u(null,K.DateTime.fromISO(t.value))}})]})}),Object(n.jsx)("div",{className:"d-none d-md-block",children:Object(n.jsx)(E.a,Object(k.a)(Object(k.a)(Object(k.a)({},r),e),{},{onChange:function(e){return l(r.name,e)}}))})]})};function z(e){var t="people.".concat(e.index,".name");return Object(n.jsxs)("div",{children:[Object(n.jsx)(D.b,{as:p.a.Control,id:t,name:t,type:"text",required:!0}),Object(n.jsx)(D.a,{name:t,component:"div",className:"field-error"})]})}function q(e){var t="people.".concat(e.index,".dateRange");return Object(n.jsxs)("div",{children:[Object(n.jsx)(D.b,{as:$,id:t,name:t,maxDate:K.DateTime.local().toJSDate(),calendarIcon:Object(n.jsx)("i",{className:"bi-calendar-range-fill"}),clearIcon:Object(n.jsx)("i",{className:"bi-x-square"})}),Object(n.jsx)(D.a,{name:t,component:"div",className:"field-error"})]})}function W(e){var t=e.values.people.map((function(t,a){return Object(n.jsxs)(N.a,{children:[Object(n.jsxs)(N.a.Header,{className:"d-flex justify-content-between",children:[Object(n.jsx)(H,{eventKey:"people.".concat(a),children:0===t.name.length?Object(n.jsx)("em",{children:"Unnamed"}):t.name}),Object(n.jsx)(A,{index:a,values:e.values.people,arrayHelpers:e.arrayHelpers})]}),Object(n.jsx)(T.a.Collapse,{eventKey:"people.".concat(a),children:Object(n.jsxs)(N.a.Body,{children:[Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Name"}),Object(n.jsx)(z,{index:a})]}),Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Date Range"}),Object(n.jsx)(q,{index:a})]})]})})]},a)}));return Object(n.jsx)(T.a,{defaultActiveKey:"people.0",children:t})}function Q(e){var t=e.values.people.map((function(t,a){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)(z,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(q,{index:a})}),Object(n.jsx)("td",{children:Object(n.jsx)(A,{index:a,values:e.values.people,arrayHelpers:e.arrayHelpers})})]},a)}));return Object(n.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{scope:"col",children:"Name"}),Object(n.jsx)("th",{scope:"col",children:"Date Range"}),Object(n.jsx)("th",{scope:"col",children:Object(n.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),Object(n.jsx)("tbody",{children:t})]})}var X=function(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"d-md-none",children:Object(n.jsx)(W,Object(k.a)({},e))}),Object(n.jsx)("div",{className:"d-none d-md-block",children:Object(n.jsx)(Q,Object(k.a)({},e))})]})},Y=a(52),Z=a.n(Y),ee=a(14),te=a.n(ee),ae=function e(t,a){Object(b.a)(this,e),this.name=t,this.period=a},ne=function e(){Object(b.a)(this,e),this.name="",this.taxRate=0,this.amount=new te.a(0),this.split=!0},le=function(){function e(t,a){Object(b.a)(this,e),this.usageTotal=t,this.generalTotal=a}return Object(x.a)(e,[{key:"total",value:function(){return this.usageTotal.add(this.generalTotal)}}]),e}(),ce=function(e){Object(d.a)(a,e);var t=Object(o.a)(a);function a(e,n,l){var c;return Object(b.a)(this,a),(c=t.call(this,n,l)).name=e,c}return a}(le),re=function(){function e(){Object(b.a)(this,e),this.lines=[],this.totalAmount=new te.a(0)}return Object(x.a)(e,[{key:"total",value:function(){if(0===this.lines.length)return new le(new te.a(0),new te.a(0));var t=this.lines.filter((function(e){return e.split})),a=this.lines.filter((function(e){return!e.split}));if(0===t.length){var n=new ne;n.split=!0,t.push(n)}if(0===a.length){var l=new ne;l.split=!1,a.push(l)}e._applyTax(t),e._applyTax(a);var c=e._accumulate(t),r=e._accumulate(a);return new le(c,r)}},{key:"split",value:function(e,t,a){if(0===a.size)return[];for(var n=this.total(),l=n.usageTotal.div(e.length("days")),c=Array.from(Z.a.mark((function t(){var a;return Z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.length("days"))){t.next=7;break}return t.next=4,e.start.plus({days:a});case 4:++a,t.next=1;break;case 7:case"end":return t.stop()}}),t)}))()),r=new Map,s=0,i=0,j=c;i<j.length;i++){var d,o=j[i],b=0,x=Object(u.a)(t);try{for(x.s();!(d=x.n()).done;){var h=d.value;null!==h.period&&h.period.contains(o)&&b++}}catch(A){x.e(A)}finally{x.f()}0===b&&(b=a.size,s++),r.set(o,b)}for(var O=l.div(a.size).times(s),m=new Map,v=0,p=c;v<p.length;v++){var f=p[v];m.set(f,l.div(r.get(f)))}var y,g=n.generalTotal.div(a.size),k=[],N=Object(u.a)(a);try{for(N.s();!(y=N.n()).done;){var T,w=y.value,D=new te.a(0).plus(O),R=Object(u.a)(t);try{for(R.s();!(T=R.n()).done;){var S=T.value;if(S.name===w){var C,_=Object(u.a)(c);try{for(_.s();!(C=_.n()).done;){var I=C.value;null!==S.period&&S.period.contains(I)&&(D=D.plus(m.get(I)))}}catch(A){_.e(A)}finally{_.f()}}}}catch(A){R.e(A)}finally{R.f()}k.push(new ce(w,D,g))}}catch(A){N.e(A)}finally{N.f()}return k}},{key:"valid",value:function(){return this.total().total().minus(this.totalAmount).abs().round(2).gte(.001)?"Bill total not equal to the sum of the lines.":""}}],[{key:"_applyTax",value:function(e){var t,a=Object(u.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.amount=n.amount.times(n.taxRate+1)}}catch(l){a.e(l)}finally{a.f()}}},{key:"_accumulate",value:function(e){var t,a=new te.a(0),n=Object(u.a)(e);try{for(n.s();!(t=n.n()).done;){var l=t.value;a=a.plus(l.amount)}}catch(c){n.e(c)}finally{n.f()}return a}}]),e}();var se=function(e){if(0===e.portions.length)return null;var t=e.portions.map((function(e){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:e.name}),Object(n.jsxs)("td",{children:["$",e.generalTotal.round(2).toFixed(2)]}),Object(n.jsxs)("td",{children:["$",e.usageTotal.round(2).toFixed(2)]}),Object(n.jsxs)("td",{children:["$",e.generalTotal.plus(e.usageTotal).round(2).toFixed(2)]})]},e.name)}));return Object(n.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),Object(n.jsx)("th",{children:"General"}),Object(n.jsx)("th",{children:"Usage"}),Object(n.jsx)("th",{children:"Total"})]})}),Object(n.jsx)("tbody",{children:t})]})},ie=a.p+"static/media/app-icon.93bc18a9.svg",je={bill:{total:0,dateRange:[K.DateTime.local().minus({months:1}).toJSDate(),K.DateTime.local().toJSDate()]},lines:[{name:"",amount:0,tax:0,usage:!0}],people:[{name:"",dateRange:[K.DateTime.local().minus({months:1}).toJSDate(),K.DateTime.local().toJSDate()]}]},de=function(){function e(){Object(b.a)(this,e)}return Object(x.a)(e,null,[{key:"_dateFromISO",value:function(e){return null===e?e:K.DateTime.fromISO(e)}},{key:"toValues",value:function(t){var a=t.searchParams.get(e._paramName);if(null===a)return null;try{var n=JSON.parse(a);n.bill.dateRange=n.bill.dateRange.map(this._dateFromISO);var l,c=Object(u.a)(n.people);try{for(c.s();!(l=c.n()).done;){var r=l.value;null!==r.dateRange&&(r.dateRange=r.dateRange.map(this._dateFromISO))}}catch(s){c.e(s)}finally{c.f()}return n}catch(i){return null}}},{key:"fromValues",value:function(t){var a=new URL(document.location),n=JSON.stringify(t,(function(e,t){if(!e.startsWith("_"))return t}),null);return a.searchParams.set(e._paramName,n),a}}]),e}();de._paramName="data";var oe=function(e){Object(d.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).state={bill:new re,results:[]},n.handleCalculate=n.handleCalculate.bind(Object(j.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.handlePermalink=n.handlePermalink.bind(Object(j.a)(n)),n.validate=n.validate.bind(Object(j.a)(n)),n}return Object(x.a)(a,[{key:"handleCalculate",value:function(e){var t=this.createBill(e),a=this.createPeople(e),n=Object(i.a)(a,2),l=n[0],c=n[1],r=t.split(K.Interval.fromDateTimes(e.bill.dateRange[0],e.bill.dateRange[1]),c,l);this.setState({results:r})}},{key:"handlePermalink",value:function(e){var t=de.fromValues(e),a=document.getElementById("permalink-display");a.getElementsByTagName("input")[0].value=t.toString(),a.classList.remove("invisible")}},{key:"copyPermalink",value:function(){var e=document.getElementById("permalink-display").getElementsByTagName("input")[0],t=document.designMode;document.designMode="on",e.select(),document.execCommand("copy",!1,e.value),document.designMode=t}},{key:"handleSubmit",value:function(e,t){var a=e._submitButton;"calculate"===a?this.handleCalculate(e,t):"permalink"===a&&this.handlePermalink(e,t),t.setSubmitting(!1)}},{key:"validate",value:function(e){var t={},a=this.createBill(e).valid();a.length>0&&(t.lines=a);var n,l=K.Interval.fromDateTimes(e.bill.dateRange[0],e.bill.dateRange[1]),c=Object(u.a)(e.people);try{for(c.s();!(n=c.n()).done;){var r=n.value;if(null!==r.dateRange){var s=K.Interval.fromDateTimes(r.dateRange[0],r.dateRange[1]);if(!l.engulfs(s)){t.people=r.name+" has dates outside the bill date range.";break}}}}catch(i){c.e(i)}finally{c.f()}return t}},{key:"createBill",value:function(e){var t=new re;t.totalAmount=new te.a(e.bill.total);var a,n=Object(u.a)(e.lines);try{for(n.s();!(a=n.n()).done;){var l=a.value,c=new ne;c.name=l.name,c.amount=new te.a(l.amount),c.taxRate=l.tax/100,c.split=l.usage,t.lines.push(c)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"createPeople",value:function(e){var t,a=new Set,n=[],l=Object(u.a)(e.people);try{for(l.s();!(t=l.n()).done;){var c=t.value;a.add(c.name);var r=null;null!==c.dateRange&&(r=Array.isArray(c.dateRange)?K.Interval.fromDateTimes(c.dateRange[0],c.dateRange[1]):K.Interval.after(c.dateRange,{days:1})),n.push(new ae(c.name,r))}}catch(s){l.e(s)}finally{l.f()}return[a,n]}},{key:"render",value:function(){var e,t=this,a=null!==(e=de.toValues(new URL(document.location)))&&void 0!==e?e:je;return a._submitButton="",Object(n.jsxs)("div",{children:[Object(n.jsx)(h.a,{bg:"dark",variant:"dark",children:Object(n.jsxs)(h.a.Brand,{children:[Object(n.jsx)("img",{alt:"",src:ie,width:"30",height:"30",className:"d-inline-block align-top"})," ","Split Bill"]})}),Object(n.jsx)(O.a,{fluid:"md",children:Object(n.jsx)(D.e,{initialValues:a,validate:this.validate,onSubmit:this.handleSubmit,children:function(e){return Object(n.jsx)("div",{children:Object(n.jsxs)(D.d,{children:[Object(n.jsx)(m.a,{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)("h1",{children:"Bill"}),Object(n.jsxs)(p.a.Row,{children:[Object(n.jsx)(v.a,{children:Object(n.jsxs)(p.a.Group,{controlId:"bill.total",children:[Object(n.jsx)(p.a.Label,{children:"Total"}),Object(n.jsxs)(f.a,{children:[Object(n.jsx)(f.a.Prepend,{children:Object(n.jsx)(f.a.Text,{children:"$"})}),Object(n.jsx)(D.b,{as:p.a.Control,name:"bill.total",type:"number",min:"0",step:"0.01"})]})]})}),Object(n.jsx)(v.a,{sm:"auto",children:Object(n.jsxs)(p.a.Group,{controlId:"bill.dateRange",children:[Object(n.jsx)(p.a.Label,{children:"Date Range"}),Object(n.jsx)(D.b,{as:$,name:"bill.dateRange",maxDate:K.DateTime.local().toJSDate(),calendarIcon:Object(n.jsx)("i",{className:"bi-calendar-range-fill"}),clearIcon:null})]})})]})]})}),Object(n.jsx)(m.a,{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)("h1",{children:"People"}),Object(n.jsx)(D.c,{name:"people",children:function(t){return Object(n.jsx)(X,{values:e.values,arrayHelpers:t})}}),e.errors.people&&Object(n.jsx)(y.a,{variant:"danger",children:e.errors.people})]})}),Object(n.jsx)(m.a,{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)("h1",{children:"Lines"}),Object(n.jsx)(D.c,{name:"lines",children:function(t){return Object(n.jsx)(M,{values:e.values,arrayHelpers:t})}}),e.errors.lines&&Object(n.jsx)(y.a,{variant:"danger",children:e.errors.lines})]})}),Object(n.jsx)(m.a,{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)("h1",{children:"Results"}),Object(n.jsxs)("div",{className:"result-buttons",children:[Object(n.jsx)(g.a,{className:"result-buttons__calculate",variant:"primary",type:"submit",disabled:e.isSubmitting||e.isValidating||!e.isValid,onClick:function(){return e.setFieldValue("_submitButton","calculate")},children:"Calculate"}),Object(n.jsx)(g.a,{className:"result-buttons__permalink",variant:"secondary",type:"submit",disabled:e.isSubmitting,onClick:function(){return e.setFieldValue("_submitButton","permalink")},children:"Create Permalink"}),Object(n.jsxs)(f.a,{id:"permalink-display",className:"result-buttons__permalink__display invisible",children:[Object(n.jsx)(p.a.Control,{type:"text"}),Object(n.jsx)(f.a.Append,{children:Object(n.jsxs)(g.a,{variant:"outline-primary",type:"button",onClick:t.copyPermalink,children:[Object(n.jsx)("span",{className:"sr-only",children:"Copy"}),Object(n.jsx)("i",{className:"bi-clipboard"})]})})]})]}),Object(n.jsx)(se,{portions:t.state.results})]})})]})})}})})]})}}]),a}(c.a.Component);s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(oe,{})}),document.getElementById("root"))}},[[89,1,2]]]);
//# sourceMappingURL=main.fb3dc350.chunk.js.map